\chapter{Unidad II}
\section{Modelo OSI}
Pensemos en administración en la integración de varios elementos para manejar de forma eficiente y eficaz el manejar las edes de computadoras.

\begin{itemize}
    \item {Administrar: planificación de la mejor manera para una mejor gestión de la red-}
    \item {Gestionar: implementación de modificaciones y crreccionaes para alcanzar los objetivos de la red}
\end{itemize}

\subsubsection{Administración de sistemas}
Suma total de las políticas y procedimientos que intervienen en la configuración, control y monitoreo que conforman una red, con el fin de aseurar el eficiente y efectivo empleo de sus recursos. \\\\

Se le solicita a la ISO que diseñe un modelo de administración OSI 

\subsubsection{Modelo de administración OSI}

La Organización de Estándares INternacionales creó una comisión para crear un modelo de administración de redes, bajo la dirección del grupo OSI.

Surge como un modelo que involucra tanto la PC como la red, buscando una coordinación e integración entre si aún que se traten de modleos distintos.

\subsubsection{Modelo de administración de redes OSI (OSI-NMM)}
Es un modelo estándar que proporciona el marco conceptual para la organización de una amplia gama de recursos de la red.\\\\
Planificación de la capacidad de red\\\\
Gestión del rendimiento de la red\\

Comprende la administración de sistemas que delimita la operación de cualquiera de las 7 capas del modelo OSI, y la administración de los objetos gestionados,
Plantea los modelos de:
\begin{itemize}
    \item Organización
    \item Información
    \item Comunicación
    \item Función
\end{itemize}

\subsubsection{Modelo organizacional}
Describe lso componentes de la administración de redes tales como administrador, agente y otros, y sus interrelaciones.
Sus relaciones vienen dadas por la arquitectura de red.\\\\
El modelo organizacional del modelo OSI define los bloques y la relación entre estos.\\\\

Es una estructura dividida en dominios de red, los cuales comprenden su operabilidad y ofrece soporte de los aspectos de gestión del mismo.\\\\
Define conceptos para una gestión cooperativa, como para una gestión basada en jerarquías:
\begin{itemize}
    \item COncepto simétrico - entre dominios
    \item Concepto asimétrico - entre dominios y subdominios
\end{itemize}

\paragraph{Dominio ejemplo}
www.ipn.mx \\
\textbf{www.escom.ipn.mx}\\
\textbf{www.saes.escom.ipn.mx}
Dónde el tercer y segundo ejemplo son subdiminios del primero 
\subsubsection{Gestión de dominios}
Define la división de entorno, teniendo en cuenta dos moibos principales:
\begin{itemize}
    \item {Políticas funcionales, donde se incluyen políticas de seguridad contabilidad etc}
    \item {Políticas no funcionales, como la gestión geográfica, tecnologías, etc}
\end{itemize}
\subsubsection{Sub modelo informativo}
Trata de la estructura y almacenamiento de la información relativa a la administración de la red \\\\
Esta información se guarda en una base de datos la cual recube nombre de base de datos de información de administración \textbf{(MIB)} Es un archivo que guarda información sobre nuestras redes, el cual se encuentra en todas las capas de administración.
\subsubsection{Sub modelo conunicacional}
Habla de la forma como se comunican los datos de administración en el proceso gestir-agente\\\\
Atiende lo relacionado con el protocolo de transporte, el protocolo de aplicaciones y los comandos y respuestas entre pares. (Como me comunico, como lo hago, formato de mis tramas, que protocolos usaré, etc.)

\subsubsection{Modelo funcional}
Divide la complejidad de la administración en áreas funcionales de administración e intenta especificar funciones de administración genéricas.\\\\
EL modelo funcional proporciona las bases para construir librerías y soluciones.\\\\
áreas de administración del modelo OSI
\begin{itemize}
    \item {Administración de fallas (fault management)}
    \item {Administracion de configuración (configuration management)}
    \item {Administración de estadísticas y contabilidad (accounting amanager) [Comportamiento de la red y si todo está dentro de los rangos permitidos, además de saber cuanto se va a cobrar]}
    \item {Administración de desempeño (performance management) [Que todo este funcionando bien, saber si es posible hacer mejoras, etc.]}
    \item {Administración de seguridad (security management) [Quién tiene acceso a que si quien trata de accesar tiene permisos, etc]}
\end{itemize}

\subsection{CMIS (Servicios de interopabilidad de gestión de contenidos)}
Es un estándar, solo sabemos que cosas debe hacer. CMIS permite la interoperabilidad entre los distintos servicios que tenemos, el gestor hace pull-in y recaba información de todos los agentes.

\textbf{T-1.1 Levantar la siguiente topología GNS3 192.168.0.0/24: Bajar las ISOS router3600, Switch3600 crear dos máquinas virtuales basadas en linux. }
\begin{lstlisting}
    enable
    conf 
    configure ter 
    configure terminal 
    inte
    interface e 
    ip add 
    ip address
    ip address 192.268.0.1 255.255.255.128
    no shutdown
    e
    exit
    inte e 0/1
    ip address  
\end{lstlisting}

\section{CMIS (Servicio de interoperabilidad de gestión de contenidos)}
Surge como un impulso de varias instituciones privadas.\\\\

Estandar abierto de OASIS diseñado para la interoprabilidad de lso sistemas de gestión de contenidos a través d einternet\\

A través d euna capa de abstración permite la gestión de contenidos.\\\\

\subsection{Sistema de gestión de contenidos o CMS}
Podemos hacer una analogía con el periódico, antes si se compraba un periódico a cualquier hora del día tenías la misma información, hoy en día tienes información en tiempo real, además de tener aglomeradas varias fuentes. CMS funciona de esta manera, un manejo dinámico de la información.\\

Aplicación que explota un entorno de trabajo para la creación y administración de contenidos.

Se usa intensamente en páginas web.

Usa una o varias bases de datos para alojar el contenido del sitio web.

Permite manejar de forma independiente el contenido y el diseño.

\subsection{Objetivos}

CMIS fué diseñado para majorar los sitemas de administración de contenido empresarial que existen junto con sus interfaces de aplicación actual junto con una capa de abstracción que nos permite homogeneizar la información.

\subsection{Historia}
EMC, IBM y Microsoft propusieron este formato.

Las tres empresas enviaron de forma conjunta CMIS a OASIS. Esta propuesta fue aprobada en 2010 y tuvo una actualizació en 2012. 

\subsection{Definiciones}
\begin{itemize}
    \item Modelo de dominio
    \item Enlaces de servicios web
    \item Rest ful y AtomPub: Difusión web usando XML y un protocolo simple basado en HTTP
\end{itemize}

\subsection{ Enfoque de CMIS }
CMIS se enfoca en las capacidades de contenido básico d eun sistema de administración de contenido empresarial, las cuales son la \textbf{creación, lectura, escritura, borrar y funciones de petición} todo se maneja jerarquicamente como un árbol. 

\subsection{Alcances CMIS}
CMIS incorpora conceptos contemporáneos de una orientación de servicios web y especificaciones ambas basadas en SOAP y REST (Estos últimos nos permiten tener una interoperabilidad entre objetos). 

\subsection{CMIS}
Los trabajadores pueden usar una única aplicación para acceder e intercambiar contenido que esta almacenado en varios sistemas de gestión empresarial sin importar que sean diferentes las computadoras.

\subsubsection{Otros estándares}
\begin{itemize}
    \item JCR Java Content Repository (Bastante complicado de utilizar)
    \item WebDAV (Muy jóven)
\end{itemize}

\subsection{Funciones genéricas de CMIS}
Crear, acceder a versiones de documentos y crear, leer actualizar, relacionar y borrar obketos

\subsection{Object identity ODI}
En el momento que se crea un objeto se crea un OID el cual es intransfereible (como una primary key de un objeto).

\subsubsection{Jerarquía de documentos}
Se usan folders y usa unaestructura de árbol normal, se manejan archivos completos y sin flujo de contenidos
'\subsection{CRUD}
\begin{itemize}
    \item Creación
    \item Recuperación
    \item Actualización
    \item Eliminación
\end{itemize}

\section{CMIP}
CMIS es un protocolo!, no nos dice como hacer las cosas solo como deben hacerse las cosas.  Desarrollado por la ISO, ofrece un mecanismo de transporte en la forma de servicio pregunta-respuesta para las 7 capas del modelo OSI. Imaginemos que tenemos una PC que ejecuta un software de administración de servicios y diversos dispositivos de red (Switch, routers, PC, etc) en cada uno de esos dispositios está en ejecución un pequeño programa llamado agente, mientras que en en la PC que tiene el software de administración de servicios tenemos el gestor. El gestor usando pull-in hace preguntas a los agentes (Dame información en el MIB (Base de Información de Administración), el agente responde). El recaba información, realiza estadisticas etc. Posteriormente el gestor envia una respuesta con el fin de ajustar algo en los agentes. Finalmente los dispositivos de red responden si se ha hecho lo que el gestor ha pedido.\\\\

Es considerada como parte d euna arquitectura de administración de red, que provee mecanismos de intercambio de información, entre un administrador y elementos remotos de red, cuyo funcionamiento está basado en los servicios CMIP.\\\\

Los sistemas de administración de red, basados en CMIP son utilizados en la administración de:

\begin{itemize}
    \item Redes de área local, LAN.
    \item Redes corporativas y provadas de área amplia.
    \item Redes nacionales e internacionales.
\end{itemize}

Define la información en términos de objetos administrados.

Permite su modificación y acciones sobre archivos

\subsection{Sistemas de administración de red o NMS}
Es un conjunto de aplicaciones que supervisan y controlan los dispositivos administrados.

Proporcionan el volumen de recursos de procesamiento y memoria requeridos para la administración de la red.

Uno o más NMS deben existir en cualquier red.

\subsection{Unidad de datos de protocolo de aplicación}
Las tramas que utiliza CMIP para su funcionamiento

\subsection{Caracteristicas del protocolo}
\begin{itemize}
    \item Ocupa muchos recursos
    \item Tramas muy grandes
    \item Peticiones muy complicadas de realizar
\end{itemize}

\subsection{Protocolos del CMIP}
ACSE, ROSE, CMISE

\chapter{Configuración básica de R1 y Routers}
\section{Conexiones a la interfaz de comandos}
\begin{itemize}
    \item {Terminal de consola: podemos hacerlo de forma local}
    \item {Telnet/SSH: nuestro propia red de internet (La primera es sin protección la otra de forma segura)}
\end{itemize}
\section{Acceso a la interfaz de comando CLI.}
Interfaz de Línea de Comandos. Requerimos cuenta de usuario. La consola muestra algo más o menos así.

\begin{lstlisting}
    dispositivo:ruta>comando                \\Switch
    dispositivo:ruta#comando                \\Router
    dispositivo:ruta(enable)#comando      
    dispositivo:ruta(config)a#comando
    dispositivo:ruta(config-vlan)#comando
    dispositivo:ruta(config-it)#comando
\end{lstlisting}
Si en el prompt tenemos el símbolo $>$ estamos en modo switch y en modo router tenemos otro símbolo el cual provee más permisos, tenemos modo de privilegio y finalmente configuración específica.\\\\

Podemos tener del 0 - 15 modelos de dispositivo, en los dispositivos CISCO hay 0, 1 y 15. Podemos definir el medio y asignar diverss permisos o comandos de ejecucion generando nuevos grupos.

\subsection{Modos de acceso}
\begin{itemize}
    \item {Solo lectura: show}
    \item {Lectura-escritura: set show}
\end{itemize}

\subsection{USAMOS GNS3}
\begin{itemize}
    \item {1. crear proyecto nuevo}
    \item {2. Cuantas direcciones IP requiero para una comunicación troncal? Requiero dos, pero también la IP y dirección de broadcast, además la máscara es decir 10.10.0.0/30, }
\end{itemize}
Configuramos Router 1 abriendo consola:
\begin{lstlisting}
    R1#disable
    R1>enable 
    R1# ?               //Comandos a ejecutar
    R1# c?              //Comandos que inician con c
    R1# configure?      //'comandos' del comando
    R1# conf terminal          //configurar terminal 
    R1(config)#interface et
    R1(config)#interface ethernet 0/1
    R1(config-if)#ip a
    R1(config-if)#ip add
    R1(config-if)#ip address 192.168.0.1 255.255.255.0
    R1(config-if)#no shutdown
    R1(config-if)#exit 
    R1(config)# inter e0/0      //Segundo router
    R1(config-if)#ip add 
    R1(config-if)#ip address 10.10.0.0 255.255.255.252
    R1(config-if)#no shut 
    R1(config-if)#exit
    R1(config)#
\end{lstlisting}

Virtual PC
\begin{lstlisting}
    PC-1> ip ? // que podemos hacer 
    PC-1> ip address ip 192.168.0.2 24 192.168.0.1
    PC-1> ping 192.168.0.1
\end{lstlisting}

\begin{lstlisting}
    R1#show ip address brief
\end{lstlisting}

\begin{lstlisting}
    R1#show ip route    //Tabla de enrutamiento (Hasta a donde llega mi router)
\end{lstlisting}

Algunos comandos simples
\begin{lstlisting}
    R1#conf t
    R1(config)#prompt "Curso4CM1"
\end{lstlisting}
\begin{lstlisting}
    R1#conf t 
    R1(config)#host name "Curso4CM1"
    Curso4CM1#
\end{lstlisting}
Usando password
\begin{lstlisting}
    R1#conf t
    R1(config)#enable password 1234
    R1(config)#end 
    R1#disable 
    R1>enable //Ahora pedirá password
\end{lstlisting}

\begin{lstlisting}
    R1#show running-config //Configuración y comandos que debo ejecutar
\end{lstlisting}

\begin{lstlisting}
    R1#show running-config | include pass //Mostrar el password
\end{lstlisting}

Contraseña segura
\begin{lstlisting}
    R1#conf t
    R1(config)#enable secret 12345678
    R1#end 
    R1#show running-config | include enable
\end{lstlisting}

Activar el servicio de encriptación
\begin{lstlisting}
    R1#conf t
    R1(config)#service password-encryption
    R1(config)#exit
    R1#show running-config | include pass
\end{lstlisting}

Ya hemos crado un password, el cual tiene como fin el cambio de privilegios, pordemos también poner un password para abrir la consola.
\begin{lstlisting}
    R1#conf t
    R1(config)#line console 0
    R1(config-line)#password 1234
    R1(config-line)#login 
    R1(config-line)#exit 
    R1(config)#exit
    R1#disable 
    R1enable //Pedirá password 
\end{lstlisting}

Quiero conexión remota de R2 a R1\\
Puerto telnet = 22, requerimos un password.
\begin{lstlisting}
    R2#telnet 10.10.0.1 //Requiere password y no la tenemos, entonces debemos configurar primero a donde nos vamos a conectar (añadir password a R1)
\end{lstlisting}

Configuramos password para telnet
\begin{lstlisting}
    R1#conf t
    R1(config)#line vty 0 15 //Accesos completos, cisco usa permisos de seguridad de 0 a 15 pero solo tenemos acceso a 3 
    R1(config)#password 1234
\end{lstlisting}

Intentamos de nuevo con R2 conectarnos
\begin{lstlisting}
    R2#telnet 10.10.0.1 //Ahora nos pedirá password, para nuestro caso es 1234, ahora estamos en R1
    R1
\end{lstlisting}

Configuración de SSL: tiene mayor nivel de seguridad. Podemos encriptar las tramas
\begin{lstlisting}
    R1disable
    R1show ssh //Esta desactivado
\end{lstlisting}

Asignando llave y dominio 
\begin{lstlisting}
    R1enable
    R1#conf t
    R1(config)#ip domain-name curso4CM1.com//Configuramos el dominio, este tiene relación lógica o práctica algo que nos vuelve comunes.
    R1(config)#crypto key generate rsa general-keys //Definimos una llave de encriptación
    How many bits in the modulus [512]: 1024 //Asignamos el tamaño de llave en este caso 1024 bytes
\end{lstlisting}

Tiempo de inactividad, se cae la conexión en n segundos 
\begin{lstlisting}
    R1(config)#ip ssh time-out 30 //En 30 segundos se cancela la conexión
\end{lstlisting}

Número de intentos si falla el password 
\begin{lstlisting}
    R1(config)#ip ssh authentication-retries 3 //A los 3 intentos se cancela la conexión 
\end{lstlisting}

Configuración versión de ssh 
\begin{lstlisting}
    R1(config)#ip ssh version 2
\end{lstlisting}

Privilegios 
\begin{lstlisting}
    R1(config)#username admin privilege 15 pass 1234 //Asignamos un nivel de privilegios 15 con el password 1234
\end{lstlisting}

\begin{lstlisting}
    R1(config)#line vty 0 4 //Modo de configuración de una terminal virtual (remota)
    R1(config-line)#transport input ssh //Me comunicaré usando SSH
    R1(config-line)#login local //Desde dónde haré la verificación de password, imaginemos que tenemos un server que tiene los controles de acceso. En este caso todo se hará localmente
\end{lstlisting}

Verificamos usando R2 que todo esté bien 
\begin{lstlisting}
    R2#ssh -v 2 -l admin 10.10.0.1 //En mi caso no pude especificar la versión por tanto removemos ese comando
    R2#ssh -l admin 10.10.0.1 //Me pedirá el password el cual es 1234 y ahora puedo acceder remotamente a R1
\end{lstlisting}
Verificamos si esta activo el SSH 
\begin{lstlisting}
    R1(config)#end 
    R1show ssh
\end{lstlisting}

Niveles de privilegio 
\begin{lstlisting}
    R1conf t
    R1(config)#privilege line//Definimos el conjunto de comando a asignar
\end{lstlisting}

\section{Enrutamiento estático y dinámico}
Estas tienen una diferencia: Recordemos en el ejemplo anterior hacíamos ping a R2 pero no teníamos respuesta. En enrutamiento dinámico cada router sabe que va ha hacer, si envian una petición sabe por que interfaz enviar una respuesta.\\
Nosotros como adminsitradores definimos un registro en la tabla de enrutamiento.

\begin{lstlisting}
    R1show ip route //Vemos tablas de enrutamiento del router  
\end{lstlisting}

Si el paquete no está en alguno de los renglones de la tabla de enrutamiento no envia nada el router.       

\section{Protocolos CMIP}

\begin{itemize}
    \item {ACSE: Se encarga de establecer las conexiones entre gestor y agente.}
    \item {ROSE: Se encarga de generar la transferencia de datos entre gestor y agente.}
    \item {CMISE: Utiliza los protocolos anteriores para administrar la red, etc. Entre los agentes.}
\end{itemize}

\chapter{Enrutamiento estático y dinámico}

\section{Enrutamiento estático}
Es la forma más simple de enrutamiento, en la que las tareas de descubrimiento de rutas y su propagación en la red son realizadas manualmente por el administrador de la internetwork. (El administrador añade una dirección)

En un esquema de enrutamiento estático una vez que la ruta es configurada, no hay necesidad de que los routers intenten descubrimientos de rutas para comunicar entre si información acerca de las mismas.
\begin{itemize}
    \item {La distancia administativa predeterminada de una ruta estática es 1}
    \item {Las rutas estáticas serán incluidas en la tabla de ruteo a menos que la red esté dieractamente conectada, o que la interfaz de salida especificada no pueda ser alcanzada por el router}
\end{itemize}

Supongamos que tenemos configurados varios protocolos, el router le da prioridad a un protocolo sobre otro, esto es la distancia administrativa.

\section{Enrutamiento dinámico}
EN el enrutamiento dinámico, la determinación de una ruta se hace usando información que es obtenida de los protocolos de enrutamiento.

Esta información se genera en respuesta a cambios en la red.

\subsection{Ventajas del enrutamiento estático}
\begin{itemize}
    \item {Eficiencia de recursos: no consume ancho de banda para intercambio y descubrimiento de rutas, no ocupa procesamiento del CPU en cálculo de rutas y requiere menos memoria}
    \item {Mayor segurodad}
    \item {Control sobre el tráfico}
    \item {Respaldo sobre rutas dinámicas: puede configurarse una ruta estática con una distancia administrativa mayor a la ruta obtenida por un protocolo a un mismo destino, en caso de que el protocolo falle se añade una ruta estática.}
\end{itemize}

\subsection{Desventajas del enrutamiento estático}
\begin{itemize}
    \item {No se adapta a cambios a al topología}
    \item {Costo de administración}
    \item {No ofrece gran escalabilidad}
\end{itemize}

\subsection{Ventajas enrutamiento dinámico}
\begin{itemize}
    \item Redundancia
    \item Multiple acceso
    \item Carga compartida 
    \item Escalable y flexible
\end{itemize}

\subsection{Desventaja del enrutamiento dinámico }
\begin{itemize}
    \item Procesamiento
\end{itemize}

\subsection{ENrutamiento estático}
Se realiza utilizando ip route 
\begin{lstlisting}
    ip route prefijo máscara {dir-reencio | vlan vlan-id}[distancia][permanente][tag valor]
\end{lstlisting}

\begin{itemize}
    \item prefijo: identificador de red 
    \item máscara: máscara de la subred 
    \item dir-reenvio | vlan vlan-id: a dónde se dará un ''brinco''
    \item distancia (opcional): especifica la métrica de la distancia para esta ruta, los valores son válidos entre 1 y 255. Las rutas con valores pequeños son las preferidas
    \item Permanente (opcional). Especifica una ruta permanente
    \item tag (opcional): especifica una etiqueta para la ruta con valores válidos entre 1 a 4294967295
\end{itemize}

\section{Protocolos}
Hay dos tipos de protocolos, los protocolos enrutables y los de enrutamiento
\subsection{Protocolos enrutables}
Tienen una dirección que deja moverse.
\begin{enumerate}
    \item IP 
    \item IPX 
    \item AppleTalk
\end{enumerate}

\subsection{Protocolos no enrutables}
Funcianan sobre una sola LAN. 
\begin{enumerate}
    \item NetBEUI 
    \item DLC 
    \item LAT 
    \item DRP 
    \item MOP
\end{enumerate}

\subsection{Protocolo de enrutamiento }
Mecanismos necesarios para compartir la información de enrutamiento. Hace que los routers compartan información, para que construyan sus tablas de enrutamientO .
\begin{enumerate}
    \item RIP 
    \item OSPF 
    \item IGRP
\end{enumerate}

\subsubsection{Objetivos}
\begin{enumerate}
    \item Identificar rutas potenciales 
    \item Deteterminar rutas óptimas 
    \item Detectar cualquier cambio en las topologías
    \item Optimización 
    \item Simplicidad y bajo gasto
    \item Solidez y estabilidad 
    \item Flexibilidad 
    \item Convergencia rápida: Si existe un cambio en la topología hay un tiempo que se da para notificar a los routers estos cambios y recalcular los algoritmos con los que se construye la tabla de enrutambiento
\end{enumerate}


\begin{itemize}
    \item Proveen reglas sintácticas y semánticas
    \item Contienen los detalles del formato de los mensajes 
    \item Describen intercambio de mensajes 
    \item Describen los proceso de comunicación 
\end{itemize}

\section{Distancia administrativa }

Valores predeterminados

\begin{longtable}[c]{|
    >{\columncolor[HTML]{00009B}}l |l|}
    \hline
    {\color[HTML]{FFFFFF} Origen de la ruta}  & \cellcolor[HTML]{00009B}{\color[HTML]{FFFFFF} Valores predeterminados de la distancia} \\ \hline
    \endfirsthead
    %
    \endhead
    %
    {\color[HTML]{FFFFFF} Interfaz conectada} & {\color[HTML]{000000} 0}                                                               \\ \hline
    {\color[HTML]{FFFFFF} RUta estática}      & {\color[HTML]{000000} 1}                                                               \\ \hline
    {\color[HTML]{FFFFFF} Ruta resumen EIGRP} & {\color[HTML]{000000} 5}                                                               \\ \hline
    {\color[HTML]{FFFFFF} Protocolo BGP}      & {\color[HTML]{000000} 20}                                                              \\ \hline
    {\color[HTML]{FFFFFF} EIGRP interno}      & {\color[HTML]{000000} 90}                                                              \\ \hline
    {\color[HTML]{FFFFFF} IGRP}               & {\color[HTML]{000000} 100}                                                             \\ \hline
    {\color[HTML]{FFFFFF} OSPF}               & {\color[HTML]{000000} 110}                                                             \\ \hline
    {\color[HTML]{FFFFFF} IS-IS}              & {\color[HTML]{000000} 115}                                                             \\ \hline
    {\color[HTML]{FFFFFF} RIP}                & {\color[HTML]{000000} 120}                                                             \\ \hline
    {\color[HTML]{FFFFFF} EIGRP externo}      & {\color[HTML]{000000} 150}                                                             \\ \hline
    {\color[HTML]{FFFFFF} BGP interno}        & {\color[HTML]{000000} 200}                                                             \\ \hline
    {\color[HTML]{FFFFFF} Desconocido}        & {\color[HTML]{000000} 255}                                                             \\ \hline
\end{longtable}

\section{COncepto de métrica y sus componentes}
\begin{itemize}
    \item Un algoritmo de enrutamiento debe determinar las ventajas de una ruta sobre otra 
    \item Para cada ruta a través de la res, un protocolo utiliza valores llamados métricas para determinar cuál es laruta óptima 
    \item Las métricas pueden tomar como base una sola característica de la ruta, o pueden calcularse tomando en cuenta distancias características 
    \item Con las métricas, el algoritmo genera un valor llamado valor métrico
\end{itemize}

\subsection{Metrícas de enrutamiento}
\begin{enumerate}
    \item Ancho de banda
    \item Retardo 
    \item Carga: permite reajustar las rutas 
    \item Confiabilidad: índice de error 
    \item Número de saltos 
    \item Tictacs 
    \item Costo 
\end{enumerate}

\subsection{Clases de protocolos de enrutamiento}
\begin{itemize}
    \item Protocolos de enrutamiento Interior (IGPs)
    \item Protocolos de enrutamiento exterior (EGPS)
\end{itemize}

Cuando nos referimos a interno y externo hablamos de dominios 

EL método en que descubren y calculan rutas 
\begin{itemize}
    \item Protocolos vector-distancia 
    \item Protocolo de estado de enlace 
    \item Protocolos híbridos balanceados 
\end{itemize}

DIreccionamiento IP 
\begin{itemize}
    \item Protocolos classful 
    \item Protocolos classless
\end{itemize}

\subsubsection{Convergencia}
Si es menor el tiempo de convergencia es mejor. 

\section{Protocolos classful}
\begin{itemize}
    \item {Los protocolos de enrutamiento classfull no incluyen máscara de red en los anuncios de red}
    \item {Dentro de la misma red, se asume una consistencia de máscaras de subred}
\end{itemize}

\section{Protocolos classless}
Requerimos enviar las máscaras y construye una estructura jerárquica dependiendo de las direcciones IP y las máscaras que se estan utilizando 
\begin{itemize}
    \item RIPV2 
    \item OSPF
\end{itemize}

\section{Protocolos de enrutamiento interior}
Se utilizan para intercambias información dentro de un siste aautónomo.

\section{Principales tipos de enrutamiento}

\begin{itemize}
    \item {Vector-distancia: Determina la dirección a partir de pares, básicamente se tiene un router y ese router tiene el identificador de red y su costo (tabla de enrutamiento)}
    \item {Estado del enlace: }
\end{itemize}

\section{Ejemplo de configuración RIPv2}

\subsection{Configuración básica}
Configurar RIPv1
\begin{itemize}
    \item {Activar protocolo RIPv1 \\ router rip}
    \item {Anunciar redes: \\ network <dirección de red> }
\end{itemize}

Configurar RIPv2 en R4
\begin{itemize}
    \item {Activar el protocolo RIPv2: \\ router rip}
    \item {Especificar la versión 2: \\ version 2}
    \item {Anunciar redes: \\ network <dirección de red>}
\end{itemize}

\begin{lstlisting}
    Rx#write //Para mantener la configuración de los routers
\end{lstlisting}

Damos por hecho que las IP
\begin{lstlisting}
    R1# conf t
    R1(config)#router rip 
    R1(config-router)#version 2
\end{lstlisting}


Recordemos que RIP envia sus tablas de enrutamiento a los routers vecinos. Cada 30s se refresca esta información.   

\begin{lstlisting}
    R1# conf t
    R1(configure)# router rip 
    R1(configure-router)# version 2
    R1(configure-router)# network 200.1.1.0 //Subred de la computadora
    R1(configure-router)# network 40.0.0.0  //Subred con los demás routers
\end{lstlisting}

¿Porqué necesito saber de donde voy y a donde voy? Imaginemos que tenemos una topología con switches o algo intermedio entre routers, debemos saber hacia donde hay que moverse, por esa razón es que rip nos dice a donde vamos a ir.

Rip soporta balanceo de cargas hasta en cinco rutas.

Hay que indicarle a RIP que haga un superneteo de las redes ya que recordemos que RIP es orientado a clases:
\begin{lstlisting}
    R3# conf t
    R3(configure)#router rip
    R3(configure--router)#no auto-summary 
\end{lstlisting}

Más comandos para monitorizar 
\begin{lstlisting}
    R1#show ip protocols
\end{lstlisting}

Como evitamos sobrecarga en ciertas interfaces? Debemos indicarselo a rip 

\begin{lstlisting}
    R3#conf t
    R3(configure)#router rip 
    R3(configure-router)#passive-interface ethernet 0/0 //donde tenemos las LAN (las computadoras conectadas)
\end{lstlisting}

Supongamos que queremos configurar un router como router de frontera en nuestro caso el router R5, como lo configuramos?
\begin{lstlisting}
    R5#conf t
    R5(configure)#router rip 
    R5(configure-router)#default-information origin
\end{lstlisting}

Si hacemos show ip route en el router R3 tenemos una red por defecto la que es la 0.0.0.0 (último renglón)\\\\

¿Que pasa si quiero combinar un protocolo dinámico con uno dinámico? Para esto rip va a difundir información que no pertenece al protocolo RIP.

Requerimos informar al router Rf que toda subred que no esté en 200.20.20 y 60.6.6.4 salga por el router R5 ¿Cómo hacemos eso? Hay que definir primero un enrutamiento estático. Que ID de red necesitamos? 0.0.0.0 con la máscara 0.0.0.0 esto para capturar todas las IP que no caigan en las dos subredes que hemos mencionado antes. Nuestro siguiente punto de salto es 60.6.6.5
\begin{lstlisting}
    Rf(config)#ip route 0.0.0.0 0.0.0.0 60.6.6.5
\end{lstlisting}

Nótese que tenemos una prioridad de 1 en este caso. 

Debemos hacer lo mismo con el router R5 en este caso.

\begin{lstlisting}
    R5(config)#ip route 200.20.20.0 255.255.255.0 60.6.6.6
\end{lstlisting}

Los demás routers no conocen esta configuración así que este router debe de informar al resto de routers

\begin{lstlisting}
    R5(config)# router rip
    R5(config)# redistribute static
\end{lstlisting}

\section{Cuenta a infinito}
Cuando hablamos de RIP el número máximo de saltos o métrica es 15 si es 16 o mayor el destino es inalcanzable. Por ejemplo si removemos una conexión a una LAN y estamos usando RIP vamos a generar una especie de ciclo hasta que elk valor de los saltos llegue a 16 esto hace que el destino se convierta en inalcanzable.


\chapter{Protocolo OSPF}
\section{Aspecto básico del protocolo OSPF}
Definido por la IETF en la RFC 2328, de Abril-98.
\begin{itemize}
    \item {Se encapsula en IP con rpotocolo 59h}
    \item {Se define 05 tipos de mensajes}
    \item {Lectura obligada}
\end{itemize}

\section{Características}
\begin{itemize}
    \item {Se hace uso del protocolo HELLO}
    \item Se envía periodicamente a la dirección multicast IP 224.0.0.5
\end{itemize}

Requiere mucha memoria ya que genera una base de datos, requiere mucho ancho de banda, ya que envía la tabla de enrutamiento e información de la BD a los routers vecinos. EN este protocolo como ya se mencionó antes se utilizan 5 tipos de mensajes, dónde el más sencillo es el mensaje ''HELLO''. 
OSPF hace que los routers conozcan la información de toda la tabla de enrutamiento.

OSPF divide todo el sistema autónomo en áreas, dónde todas las áreas deben estar conectadas al área 0, dónde el área cero es el área de backbone es la columna vertebral de OSPF.
\subsection{Observaciones al estado de enlace}
\begin{itemize}
    \item {Los routers de enlace requieren más memoria y potencia de procsamiento, que un router vector-distancia}
    \item {Al inicio del proceso se debe inundar la red con mensaje LSA, puede degradar la red}
    \item {Hay que dividir la red en áreas}
\end{itemize}
\subsection{Configuración}
\begin{lstlisting}
    Rx#conf t
    Rx(config)#router ospf process-ID //Debe ser el mismo para todos los routers
    Rx(config-router)# network dirección_de_red wildcard /*comodín*/ area area_ID
    Rx(config-router)#exit
\end{lstlisting}
El wildcard es el inverso de la máscara por ejemplo si la máscara es 255.255.255.252 el inverso es 0.0.0.3

\section{Wildcard}
\subsection{Bits de máscara wildcard}
Una máscara wildcard es un número de 32 bits dividido en cuatro octetos (como IP)\\
El enmascaramiento wildcard es utilizado por las ACL para identificar una sola dirección o múltiples direcciones para pruebas d epermiso y denegación\\ 
No guardan relación funcional con las máscaras de subred\\
ALgunas veces, se refiere a una máscara de wildcard como una máscara inversa.\\\\

Un bit a 0 en la mmáscara significa comprobar el valor correspondiente y un 1 es ignorar el valor correspondiente.\\\\
Ejemplo: tenemos la dirección \\
30.15.25.0/26 supongamos que me interesan todas las direcciones IP pares de esta LAN. La máscara es 255.255.255.192\\\\

\begin{longtable}[H]{|l|l|l|l|}
    \hline
    \rowcolor[HTML]{FFFFFF} 
    {\color[HTML]{333333} 255}                  & {\color[HTML]{333333} 255}                  & {\color[HTML]{333333} 255}                 & {\color[HTML]{333333} 192}                      \\ \hline
    \endfirsthead
    %
    \endhead
    %
    \rowcolor[HTML]{FFFFFF} 
    {\color[HTML]{333333} 30}                   & {\color[HTML]{333333} 15}                   & {\color[HTML]{333333} 25}                  & {\color[HTML]{333333} 00xxxxxx}                 \\ \hline
    \rowcolor[HTML]{FFFFFF} 
    \multicolumn{4}{|l|}{\cellcolor[HTML]{FFFFFF}{\color[HTML]{333333} Los primeros 26 bits nos interesan es decir:}}                                                                        \\ \hline
    \rowcolor[HTML]{FFFFFF} 
    {\color[HTML]{333333} 0}                    & {\color[HTML]{333333} 0}                    & {\color[HTML]{333333} 0}                   & {\color[HTML]{333333} 00}                       \\ \hline
    \rowcolor[HTML]{FFFFFF} 
    \multicolumn{4}{|l|}{\cellcolor[HTML]{FFFFFF}{\color[HTML]{333333} El último bit nos define la paridad por tanto, solo el último bit nos importa saber que valor tiene (debe ser cero)}} \\ \hline
    0                                           & 0                                           & 0                                          & 0011111110                                      \\ \hline
    \multicolumn{4}{|l|}{Con lo cual obtenemos nuestro wild card}                                                                                                                            \\ \hline
    0                                           & 0                                           & 0                                          & 62                                              \\ \hline
\end{longtable}

Tomemos de nuevo el wildcard 0.0.0.3:
\begin{longtable}[H]{|
    >{\columncolor[HTML]{FFFFFF}}l |
    >{\columncolor[HTML]{FFFFFF}}l |
    >{\columncolor[HTML]{FFFFFF}}l |
    >{\columncolor[HTML]{FFFFFF}}l |
    >{\columncolor[HTML]{FFFFFF}}l |}
    \hline
    wildcard:                                  & {\color[HTML]{333333} 0}  & {\color[HTML]{333333} 0} & {\color[HTML]{333333} 0} & {\color[HTML]{333333} 00000011}                                 \\ \hline
    \endfirsthead
    %
    \endhead
    %
    IDred:                                     & {\color[HTML]{333333} 10} & {\color[HTML]{333333} 2} & {\color[HTML]{333333} 3} & {\color[HTML]{333333} 00000100}                                 \\ \hline
    \cellcolor[HTML]{FFFFFF}                   & {\color[HTML]{333333} 10} & {\color[HTML]{333333} 2} & {\color[HTML]{333333} 3} & {\color[HTML]{333333} 000001( \{00\}, \{01\}, \{10\}, \{11\} )} \\ \cline{2-5} 
    \cellcolor[HTML]{FFFFFF}                   & \multicolumn{4}{l|}{\cellcolor[HTML]{FFFFFF}{\color[HTML]{333333} Por tanto tenemos redes definidas desde}}                                       \\ \cline{2-5} 
    \cellcolor[HTML]{FFFFFF}                   & {\color[HTML]{333333} 10} & {\color[HTML]{333333} 2} & {\color[HTML]{333333} 3} & {\color[HTML]{333333} 4}                                        \\ \cline{2-5} 
    \cellcolor[HTML]{FFFFFF}                   & \multicolumn{4}{l|}{\cellcolor[HTML]{FFFFFF}\begin{tabular}[c]{@{}l@{}}.\\ .\\ .\end{tabular}}                                                    \\ \cline{2-5} 
    \multirow{-5}{*}{\cellcolor[HTML]{FFFFFF}} & 10                        & 2                        & 3                        & 7                                                               \\ \hline
\end{longtable}

\section{Aspectos de configuración}
\begin{itemize}
    \item {AL iniciarse el proceso OSPF en un router, el IOS utiliza la dirección IP activa local más alta como ID del router}
    \item {Si no existe una interfaz activa, el proceso OSPF no se iniciará}
    \item {Para asegurar la estabilidad del proceso OSPF, es necesario que el router tenga una interfaz activa en todo momento}
    \item {La interfaz loopback es importante para este objetivo}
\end{itemize}

Supongamos que tenemos las siguientes direcciones IP
\begin{itemize}
    \item 20.20.20.1 
    \item 20.20.30.1
    \item \textbf{20.20.40.1}
\end{itemize}
OSPF va a tomar la dirección IP \textbf{20.20.40.1} ya que es la más alta. Esto vuelve inestable todo OSPF ya que al conectar más redes no obtendremos a veces la dirección IP más alta, si la interfaz con la IP más alta falla nuevamente volvemos OSPF inestable. Es decir OSPF es dependiente de las interfaces con las que se está trabajando. Para solucionar esto utilizamos interfaces loopback.
Si se tienen varias ip de loopback nuevamente elige la que tenga la IP más alta.\\\\

Ahora debemos de responder lo siguiente ¿Cómo definimos el router designado y el designado de respaldo? Esto se realiza con la prioridad 
\begin{lstlisting}
    R(config)#interface serial 0/0/0
    R(config-if)#ip priority n_prioridad
\end{lstlisting}
Un valor de prioridad puede variar de 0 a 255 \\

Valor 0 de prioridad imposibilita al router que sea elegido DR \\